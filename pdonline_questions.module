<?php

function pdonline_questions_menu()
{
	$items = array();
	$items['questions'] = array
	(
		'title' => 'Questions',
		'description' => 'Answer all the questions',
		'page callback' => 'drupal_get_form',
		'page arguments' => array('questions_form'),
		'access callback' => 'user_access',
		'access arguments' => array('access content'),
		'type' => MENU_NORMAL_ITEM
	);

	$items['report'] = array
	(
		//'title' => 'Questions',
		//'description' => 'Answer all the questions',
		'page callback' => 'questions_report',
		//'page arguments' => array('questions_form'),
		'access callback' => 'user_access',
		'access arguments' => array('access content'),
		'type' => MENU_CALLBACK
	);
	return $items;
}

function questions_form()
{
	$oneN = rand(1,100);
	$twoN = rand(1,10);
	$threeN = rand(1,100);
	$fourN = rand(1,5);
	$fourC = chr(rand(97,122));
	$fiveN = rand(1,5);
	getOneYX($oneX, $oneY);
	$form = array();
	$form['divisible'] = array
	(
		'#type' => 'textfield',
		'#title' => '1) Is '.$oneN.' divisble by '.$oneX.' , '.$oneY.' , both or neither? <br/>
				<ul>			
					<li>If '.$oneX.' : Input "P"</li>
					<li>If '.$oneY.' : Input "D"</li>
					<li>If both: Input "PDOnline"</li>
					<li>If neither: Input n </li>
				</ul>'
	);

	$form['factorial'] = array
	(
		'#type' => 'textfield',
		'#title' => '2) What is '.$twoN.' factorial? '
	);

	$form['bits'] = array
	(
		'#type' => 'textfield',
		'#title' => '3) How many bits are set in the binary conversion of '.$threeN
	);

	$form['words'] = array
	(
		'#type' => 'textfield',
		'#title' => '4) Write '.$fourN.' words containing the character "'.$fourC.'"'
	);

	$form['html'] = array
	(
		'#type' => 'textarea',
		'#title' => '5) Write some HTML with the word "PDOnline" nested '.$fiveN.' levels deep '
	);


	$form['submit'] = array
	(
		'#type' => 'submit',
		'#value' => 'Submit'
	);

	return $form;
}

function questions_form_validate($form, &$form_state)
{
	if($form_state['values']['divisible'] == "")
	{
		form_set_error('divisible', 'Q1 is empty');
	}

	if($form_state['values']['factorial'] == "")
	{
		form_set_error('factorial', 'Q2 is empty');
	}

	if(!is_numeric($form_state['values']['factorial']))
	{
		form_set_error('factorial', 'Q2 answer can only be numeric');
	}

	if($form_state['values']['bits'] == "")
	{
		form_set_error('bits', 'Q3 is empty');
	}

	if(($form_state['values']['bits'] != "0") && ($form_state['values']['bits'] != "1"))
	{
		if((strpos($form_state['values']['bits'],'0') === false) || (strpos($form_state['values']['bits'],'1') === false))
		{
			form_set_error('bits', 'Q3 answer can only be binary');
		}
	}

	if($form_state['values']['words'] == "")
	{
		form_set_error('words', 'Q4 is empty');
	}

	if($form_state['values']['html'] == "")
	{
		form_set_error('html', 'Q5 is empty');
	}
}


function questions_form_submit($form, &$form_state)
{
		$form_state['redirect'] = 'report';
}

function questions_report()
{
	echo "Hello";
}

function getOneYX(&$oneX, &$oneY)
{
	do
	{
		$oneX = rand(2,5);
		$oneY = rand(2,5);
	}while($oneX === $oneY);
}


